{{- $personalData := "" -}}
{{- $personalFile := joinPath .chezmoi.sourceDir ".personal/data.yaml" -}}

{{- if stat $personalFile -}}
{{-   $personalData = include $personalFile | fromYaml -}}
{{- end -}}

{{- $name := "" -}}
{{- $email := "" -}}
{{- $github := "" -}}

{{- if $personalData -}}
{{-   $name = $personalData.name -}}
{{-   $email = $personalData.email -}}
{{-   $github = $personalData.github -}}
{{- else -}}
{{-   $name = promptStringOnce . "name" "Full name" -}}
{{-   $email = promptStringOnce . "email" "Email address" -}}
{{-   $github = promptStringOnce . "github" "GitHub username" -}}
{{- end -}}

{{- /* Optional package installation preferences */ -}}
{{- $installAI := promptBoolOnce . "installAI" "Install AI tools (Claude Code, Gemini CLI, Codex CLI)" -}}
{{- $installDev := promptBoolOnce . "installDev" "Install development tools (Podman, VS Code)" -}}
{{- $installProductivity := promptBoolOnce . "installProductivity" "Install productivity apps (BetterTouchTool, iStat Menus, Bitwarden)" -}}
{{- $installBrowsers := promptBoolOnce . "installBrowsers" "Install additional browsers (Firefox)" -}}

encryption = "age"

[data]
    name = {{ $name | quote }}
    email = {{ $email | quote }}
    github = {{ $github | quote }}
    installAI = {{ $installAI }}
    installDev = {{ $installDev }}
    installProductivity = {{ $installProductivity }}
    installBrowsers = {{ $installBrowsers }}

[age]
    identity = "~/.config/chezmoi/key.txt"
    recipient = ""
